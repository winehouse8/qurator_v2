# instructions.py – prompt templates
"""LLM instruction 문자열 모음

모든 문자열은 삼중따옴표로 감싸 한눈에 편집하기 쉽도록 구성했습니다.
ADK 런타임에서 {keyword}, {search_results}, {page_texts}, {cards_json}
과 같은 플레이스홀더를 그대로 치환하므로 f‑string 으로 다시 감싸지
마세요.
"""

# ---------------------------------------------------------------------------
# Google search → URL 필터
# ---------------------------------------------------------------------------
FILTER_INSTRUCTION: str = """
{search_results}
==============================
- search_results 는 list[dict] 형식이며 각 dict 의 키는 desc 와 url 이다.
- desc 를 읽고 광고나 낚시성 결과를 제외한다.
- 사용자가 요청한 카드뉴스 주제 '{keyword}' 와 연관성 높은 URL 을 최대 5개까지 고른다.
- 결과는 URL 만 요소로 갖는 Python list 로 출력한다.
  예시: ['https://a.com', 'https://b.com']
- 반드시 리스트 하나만 출력하고, 다른 텍스트는 절대 포함하지 않는다.
"""

# ---------------------------------------------------------------------------
# 본문 크롤링 결과 → 카드뉴스 초안(JSON) 생성
# ---------------------------------------------------------------------------
TEXT_MAKER_INSTRUCTION: str = """
아래 카드 작성 규칙/팁과 페이지 본문을 참고하여 '{keyword}' 주제로 카드뉴스를 작성한다.

[카드 작성 규칙]
1. 첫 번째 카드: title 키만 포함한다.
2. 두 번째 카드부터 두 가지 레이아웃 중 하나를 택해 일관되게 사용한다.
   - with_sub_title : sub_title, body 키 포함
   - no_sub_title   : body 키만 포함
3. 전체 카드 수는 2~6장 사이에서 자유롭게 정한다. 흥미로운 정보가 적으면 2~3장만 적어서, 흥미의 밀도를 올리는 것이 중요하다.
4. body 는 2~4문장, 150자 이내로 작성한다.
5. 한자 사용을 피하고 한글을 기본으로, 필요하면 영어를 부가적으로 사용한다.
6. 결과는 JSON 하나만 출력하며, 추가 설명·주석·백틱 등을 포함하지 않는다.

[카드 작성 팁]
1. title 은 보통의 SNS 포스팅 제목처럼, 쉽고 흥미로운 표현을 써서 클릭을 유도하는 제목을 쓰는것이 좋다.
2. 카드뉴스의 내용으로는 아래 검색 결과를 바탕으로, 뻔한 사실이 아닌, 구체적이고 흥미로운 내용을 쓰는것이 중요하다.
3. 여러 장소/가게/패션아이템 등을 소개하는 카드뉴스라면, 각 페이지의 sub_title에는 특정 장소/가게/패션아이템 을 특정할 수 있도록 적어야 한다.
    예를들어 여러 잠실의 여러 맛집을 소개하는 카드뉴스의 복떡볶이 라는 상호를 소개하는 페이지라면, "잠실 복떡볶이" 와 같이 지역명을 상호 앞에 붙혀서 해당 가게를 특정할 수 있도록 한다. 여기서 중요한건 지명을 붙히는 것이 아니라, 대상을 특정해서 나중에 검색할 수 있는 키워드를 sub_title로 삼는 것이다.
4. 여러 장소/가게를 소개하는 경우, body에는 해당 장소 또는 가게에 대한 간략한 장점,특징, 주요정보(주요메뉴,기간/시간 등)를 쓰는것이 좋다.(그런 정보를 가지고 있는 경우에 한함)
5. with_sub_title/no_sub_title 를 선택하는 기준: 소개할 내용이 길지 않다면 2장(title 만 한장, body만 있는 한장)으로 충분한 경우가 있다.(no_sub_title 모드). 보통 특정 사건(뉴스)를 소개하는 경우,  2장의 no_sub_title 모드를 쓰는 것을 기본으로 한다. 하지만 소개할 흥미로운 내용이 많은 경우 뉴스라 할지라도 여러장을 허용한다.(with_sub_title 모드) 즉 소개할 흥미로운 내용의 양이 많은지가 with_sub_title/no_sub_title 선택의 주요 판단 기준이 된다.
6. 카드뉴스는 두괄식이 좋다. 그래서 sub_title에는 title을 보고 사람들이 가장 궁금해할 만한것을 직접적으로 적어주는것이 좋다. 예를들어 title이 애니추천 5선이면 애니 이름을 sub_title에 적는식이다.

--- 참조할 검색 결과 ---
{page_texts}
"""

# ---------------------------------------------------------------------------
# 카드뉴스 초안(JSON) → img_keyword 보강
# ---------------------------------------------------------------------------
IMG_KEYWORD_INSTRUCTION: str = """
다음은 카드뉴스 초안(JSON)이다. 각 카드에 img_keyword 를 추가하고 같은 구조의 JSON 으로 다시 출력한다.

{cards_json}

[img_keyword 작성 규칙]
Ⅰ. *정확 매칭 카드* — 특정 사건·뉴스·인물·장소·브랜드·패션·가게 등 : 소개하는 내용과 이미지가 정확히 같아야 하는 경우
    - 비유적 사진 사용 금지, 해당 대상이 드러나는 검색어만 사용한다.
    - 예) 이태원 참사 뉴스 → "이태원 참사", BTS 뷔 소개 → "뷔"
Ⅱ. *보조·정보 카드* — 일반 상식·팁·테마형 목록 등 : 소개하는 내용과 이미지가 정확히 같지 않아도 되서 비유적 사진을 써도 되는 경우
    - 추상적·복잡한 개념이라 검색 결과가 부족할 경우, 이미지가 연상되는 구체적 명사로 변환한다. (예: "알뜰폰 절약법" → "저금통" 또는 "휴대폰")
    - 내용을 돋보이게 하는 **비유적·연상형** 이미지를 사용해도 무방하다. (예 "3일만에 용변 본 썰" → "핵폭발")

[img_keyword 작성 팁]
- **첫 번째 카드**: 주제를 대표하며 시선을 끄는 검색어를 고른다.
    - 해당 페이지의 내용이 *정확 매칭 카드* 에 해당할 경우:
        - 비유적 사진 사용 금지, 해당 대상이 드러나는 검색어만 사용한다.
    - 해당 페이지의 내용이 *보조·정보 카드* 에 해당할 경우:
        - 전략1: "내용 관련 명사 + 이쁘거나 잘생긴 연예인" (예: "<연예인이름> 핸드폰") 매우 추천됨
        - 전략2: 내용과 연관된 상징적 이미지(예: 핵폭발)
        - 상기 전략이 부적절하면 내용과 정확히 일치하는 명사 사용
- **나머지 카드**: 각 카드 내용을 대표하는 명사형 검색어. 위 img_keyword 작성 규칙 분류에 맞춰 선택한다.    
- 모든 키워드는 실제 Google 이미지 결과가 풍부할 것으로 예상되는 단어여야 한다.
- 텍스트가 많은 이미지는 피하고, 배경용으로 적합한 사진을 고른다.
- **특징별 연예인 참고**
  • 이쁜 여자 아이돌: 장원영, 카리나, 권은비
  • 잘생긴 남자 아이돌: 차은우, 방탄소년단 뷔
- 결과는 JSON 하나만 출력하고, 다른 설명은 절대 포함하지 않는다.

[특수 사례 규칙]
특수 사례 규칙은, 다른 규칙보다 우선한다.
1. 가게/장소를 소개하는 카드: 예를들어 여러 잠실의 복떡볶이 라는 상호를 소개하는 페이지라면, "잠실 복떡볶이" 와 같이 지역명과 상호를 같이 붙혀서 해당 가게를 특정할 수 있도록 한다. 여기서 중요한건 지명을 붙히는 것이 아니라, 대상을 특정해서 나중에 검색할 수 있는 키워드를 img_keyword 로 삼는 것이다.
2. 독립적인 N 개의 *정확 매칭 카드* 를 소개하는 카드뉴스: '리그오브레전드 대표선수 4인 소개', '남자 운동화 브랜드 Top4'와 같이 독립적인 N 개의 *정확 매칭 카드*를 소개하는 카드뉴스의 첫페이지 img_keyword로는 이후에 나올 N 개의 img_keyword 중 가장 인기있어 보이는 것을 골라 써야한다.
3. 카드뉴스가 실제 일어난 사건/뉴스 에 해당하는 경우 img_keyword는 *정확 매칭 카드* 룰에 따라 모든 페이지의 img_keyword가 해당 사건에 대한 사진만 검색 되도록 해야한다. 예를들어 "금호타이어 공장 화재" 가 뉴스 주제면, 이후 소방관에 대한 page에서는 "금호타이어 공장 화재 소방관" 이렇게 해당 사건에 특정된 소방관만 검색되도록 사건명을 같이 붙혀 검색해야한다.
"""

__all__ = [
    "FILTER_INSTRUCTION",
    "TEXT_MAKER_INSTRUCTION",
    "IMG_KEYWORD_INSTRUCTION",
]
